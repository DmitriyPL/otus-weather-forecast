{"version":3,"file":"main.js","mappings":"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","sources":["webpack://otus-weather-forecast/webpack/bootstrap","webpack://otus-weather-forecast/./src/index.js","webpack://otus-weather-forecast/webpack/runtime/define property getters","webpack://otus-weather-forecast/webpack/runtime/hasOwnProperty shorthand"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","import \"../css/normalize.css\";\nimport \"../css/style.css\";\n\nlet map;\n\nexport function saveList(key, items) {\n  localStorage.setItem(key, JSON.stringify(items));\n}\n\nexport function readList(key) {\n  const items = JSON.parse(localStorage.getItem(key));\n  return items === null ? [] : items;\n}\n\nexport function drawList(items) {\n  const listEl = document.querySelector(\"#list\");\n\n  listEl.innerHTML = \"\";\n\n  const olEl = document.createElement(\"ol\");\n\n  items.forEach((city) => {\n    let liEl = document.createElement(\"li\");\n    liEl.innerText = city;\n    olEl.appendChild(liEl);\n\n    liEl.addEventListener(\"click\", async (event) => {\n      event.preventDefault();\n\n      const el = event.target;\n      const weatherInfo = await getWeather(el.innerText);\n      let lat = weatherInfo.coord.lat;\n      let lon = weatherInfo.coord.lon;\n      showWeather(weatherInfo, lat, lon);\n    });\n\n    liEl.onmouseover = liEl.onmouseout = changeLiBackground;\n  });\n\n  listEl.appendChild(olEl);\n}\n\nfunction changeLiBackground(event) {\n  if (event.type == \"mouseover\") {\n    event.target.style.background = \"grey\";\n  }\n  if (event.type == \"mouseout\") {\n    event.target.style.background = \"\";\n  }\n}\n\nexport function submitHandler(event, items) {\n  const formEl = event.target;\n  const input = formEl.querySelector(\"input\");\n  const { value } = input;\n  input.value = \"\";\n\n  items.push(value);\n\n  if (items.length > 10) {\n    items.shift();\n  }\n\n  return value;\n}\n\nasync function getGeo() {\n  let reqpath = \"https://get.geojs.io/v1/ip/geo.json\";\n  let resp = await fetch(reqpath);\n  return resp.json();\n}\n\nasync function getWeather(param, useCity = true) {\n  const APIKEY_YANDEXMAP = \"21ca9df46444fbd55278f1acab840a5a\"; // process.env.APIKEY_YANDEXMAP\n  let reqpath = \"\";\n  if (useCity) {\n    reqpath = `https://api.openweathermap.org/data/2.5/weather?units=metric&q=${param}&appid=${APIKEY_YANDEXMAP}`;\n  } else {\n    const lat = param[\"latitude\"];\n    const lon = param[\"longitude\"];\n    reqpath = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${APIKEY_YANDEXMAP}`;\n  }\n\n  let resp = await fetch(reqpath);\n  return resp.json();\n}\n\nfunction showWeather(weatherInfo, lat, lon) {\n  const weatherInfoEl = document.querySelector(\"#weather-info\");\n  weatherInfoEl.innerHTML = `\n  <h1>${weatherInfo.name}</h1>\n  <img src=\"http://openweathermap.org/img/wn/${weatherInfo.weather[0].icon}@2x.png\" alt=\"Weather icon\">\n  `;\n  map.setCenter([lat, lon]);\n}\n\nasync function showCurrentWeather() {\n  const geo = await getGeo();\n  let weatherInfo = await getWeather(geo, false);\n  const lat = geo[\"latitude\"];\n  const lon = geo[\"longitude\"];\n  showWeather(weatherInfo, lat, lon);\n}\n\nfunction mapInit() {\n  map = new ymaps.Map(\"map\", {\n    center: [55.76, 37.64],\n    zoom: 7,\n  });\n}\n\nfunction main() {\n  const formEl = document.querySelector(\"form\");\n  const cities = readList(\"list\");\n\n  ymaps.ready(mapInit);\n\n  showCurrentWeather();\n\n  drawList(cities);\n\n  formEl.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    const cityName = submitHandler(event, cities);\n    drawList(cities);\n    saveList(\"list\", cities);\n\n    const weatherInfo = await getWeather(cityName);\n    let lat = weatherInfo.coord.lat;\n    let lon = weatherInfo.coord.lon;\n    showWeather(weatherInfo, lat, lon);\n  });\n}\n\nmain();\n\n// eslint-disable-next-line no-unused-vars\n/* eslint-disable no-param-reassign */\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"names":["map","items","formEl","cities","__webpack_require__","i","saveList","key","localStorage","setItem","JSON","stringify","drawList","listEl","document","querySelector","innerHTML","olEl","createElement","forEach","city","liEl","innerText","appendChild","addEventListener","event","preventDefault","el","target","getWeather","weatherInfo","lat","coord","lon","showWeather","onmouseover","onmouseout","changeLiBackground","type","style","background","submitHandler","input","value","push","length","shift","getGeo","fetch","resp","json","param","useCity","APIKEY_YANDEXMAP","reqpath","name","weather","icon","setCenter","geo","d","exports","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","parse","getItem","ymaps","ready","Map","center","zoom","showCurrentWeather","cityName"],"sourceRoot":""}